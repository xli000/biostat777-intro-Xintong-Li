{
  "hash": "14c81c4610e8d203b4b9e6e4067e899d",
  "result": {
    "markdown": "---\ntitle: \"Example analysis\"\nformat: html \nbibliography: references.bib\nnocite: |\n  @*\n---\n\n\nThis analysis aims to explore the association between the frequency of feeling sad and incident alcohol dependence.\n\n::: {.column-margin}\nIncidental alcohol dependence refers to alcohol dependence during the past 30 days.\n:::\n\n## Exploratory Data Analysis\n## Data Wrangling\nThe svydesign was used to account for survey design features of the data. \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(survey)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(forcats)\n\nload(\"35067-0001-Data.rda\")\n\nd1 <- da35067.0001 %>%\n  select(AGE, EDUCAT, EMPCAT, INC_CAT, NSD1E, RESPID, CASEWGT, STR, SECU, I_ALD30) %>%\n  drop_na() %>%\n  rename(Frequency = NSD1E, Age = AGE, Education = EDUCAT, Employment = EMPCAT, Income = INC_CAT)\n\nd1w <- svydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, cluster = ~SECU, data = d1)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nggplot(d1, aes(x = Frequency, y = Age)) +\n  geom_boxplot(alpha = 0.5, width = 0.2) +  \n  geom_violin(trim = FALSE, fill = \"skyblue\", alpha = 0.5) + \n  labs(\n    title = \"Mean Age by Frequency of Feeling Sad\",\n    x = \"Frequency of Feeling Sad\",\n    y = \"Age\"\n  ) +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Example-analysis_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nedu <- as.data.frame(svytable(~Education + Frequency, design = d1w))\n\nggplot(edu, aes(x = Frequency, y = Freq, fill = Frequency)) +\n  geom_col(position = \"dodge\") +\n  facet_wrap(~ Education, scales = \"free_y\") +\n  labs(\n    title = \"Survey-Weighted Counts by Years of Education\",\n    x = \"Frequency of Feeling Sad\",\n    y = \"Count of People\",\n    fill = \"Frequency\"\n  ) +\n  theme_minimal() +\n theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Example-analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nemp <- as.data.frame(svytable(~Employment + Frequency, design = d1w))\nggplot(emp, aes(x = Frequency, y = Freq, fill = Frequency)) +\n  geom_col(position = \"dodge\") +\n  facet_wrap(~ Employment, scales = \"free_y\") +  \n  labs(\n    title = \"Survey-Weighted Counts by Employment\",\n    x = \"Frequency of Feeling Sad\",\n    y = \"Count of People\",\n    fill = \"Frequency\"\n  ) +\n  theme_minimal() +\n theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Example-analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninc <- as.data.frame(svytable(~Income + Frequency, design = d1w))\nggplot(inc, aes(x = Frequency, y = Freq, fill = Frequency)) +\n  geom_col(position = \"dodge\") +\n  facet_wrap(~ Income, scales = \"free_y\", labeller = label_wrap_gen(width = 25)) + \n  labs(\n    title = \"Survey-Weighted Counts by Income Levels\",\n    x = \"Frequency of Feeling Sad\",\n    y = \"Count of People\",\n    fill = \"Frequency\"\n  ) +\n  theme_minimal() +\n theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Example-analysis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Relevel Frequency with \"never\" as the reference group\nd1w$variables <- d1w$variables %>%\n  mutate(\n    Frequency = fct_relevel(Frequency, \"(4) Never\"),  \n    I_ALD30 = fct_relevel(I_ALD30, \"(5) Not Endorsed\")\n    )\n\na1 <- svyglm(I_ALD30 ~ Frequency, family = binomial(link = \"logit\"), design = d1w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n```\n:::\n\n```{.r .cell-code}\nsummary(a1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nsvyglm(formula = I_ALD30 ~ Frequency, design = d1w, family = binomial(link = \"logit\"))\n\nSurvey design:\nsvydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, \n    cluster = ~SECU, data = d1)\n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)             -6.7043     0.6304 -10.635  < 2e-16 ***\nFrequency(1) Often       3.4443     0.7260   4.744 2.15e-06 ***\nFrequency(2) Sometimes   2.0634     0.6908   2.987  0.00283 ** \nFrequency(3) Rarely      1.5131     0.7825   1.934  0.05323 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1.000201)\n\nNumber of Fisher Scoring iterations: 9\n```\n:::\n\n```{.r .cell-code}\nexp(coef(a1))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           (Intercept)     Frequency(1) Often Frequency(2) Sometimes \n           0.001225638           31.321832146            7.872516160 \n   Frequency(3) Rarely \n           4.540624653 \n```\n:::\n\n```{.r .cell-code}\nci <- confint(a1)\nexp(ci)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                              2.5 %       97.5 %\n(Intercept)            0.0003561422 4.217944e-03\nFrequency(1) Often     7.5455747282 1.300176e+02\nFrequency(2) Sometimes 2.0319906714 3.050039e+01\nFrequency(3) Rarely    0.9791679428 2.105591e+01\n```\n:::\n\n```{.r .cell-code}\na2 <- svyglm (I_ALD30 ~ Frequency + Age, family = binomial(link = \"logit\"), design = d1w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n```\n:::\n\n```{.r .cell-code}\nsummary(a2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nsvyglm(formula = I_ALD30 ~ Frequency + Age, design = d1w, family = binomial(link = \"logit\"))\n\nSurvey design:\nsvydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, \n    cluster = ~SECU, data = d1)\n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)            -5.89018    0.95014  -6.199 6.14e-10 ***\nFrequency(1) Often      3.42127    0.72492   4.719 2.43e-06 ***\nFrequency(2) Sometimes  2.04016    0.68558   2.976  0.00294 ** \nFrequency(3) Rarely     1.49563    0.77736   1.924  0.05441 .  \nAge                    -0.01863    0.02015  -0.924  0.35534    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1.001347)\n\nNumber of Fisher Scoring iterations: 9\n```\n:::\n\n```{.r .cell-code}\n# final model\na3 <- svyglm (I_ALD30 ~ Frequency + Age + Education, family = binomial(link = \"logit\"), design = d1w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n```\n:::\n\n```{.r .cell-code}\nsummary(a3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nsvyglm(formula = I_ALD30 ~ Frequency + Age + Education, design = d1w, \n    family = binomial(link = \"logit\"))\n\nSurvey design:\nsvydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, \n    cluster = ~SECU, data = d1)\n\nCoefficients:\n                              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                   -5.17607    1.01088  -5.120 3.17e-07 ***\nFrequency(1) Often             3.37992    0.73493   4.599 4.35e-06 ***\nFrequency(2) Sometimes         2.05463    0.68300   3.008  0.00264 ** \nFrequency(3) Rarely            1.54566    0.79097   1.954  0.05074 .  \nAge                           -0.02200    0.02071  -1.062  0.28815    \nEducation(2) 12 Years         -0.24316    0.52286  -0.465  0.64191    \nEducation(3) 13 - 15 Years    -1.63412    0.64481  -2.534  0.01130 *  \nEducation(4) 16 or More Years -0.68544    0.71081  -0.964  0.33494    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 0.9536442)\n\nNumber of Fisher Scoring iterations: 9\n```\n:::\n\n```{.r .cell-code}\nexp(coef(a3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  (Intercept)            Frequency(1) Often \n                  0.005650156                  29.368537133 \n       Frequency(2) Sometimes           Frequency(3) Rarely \n                  7.803983073                   4.691073327 \n                          Age         Education(2) 12 Years \n                  0.978241265                   0.784144983 \n   Education(3) 13 - 15 Years Education(4) 16 or More Years \n                  0.195123657                   0.503866158 \n```\n:::\n\n```{.r .cell-code}\nci1 <- confint(a3)\nexp(ci1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                     2.5 %       97.5 %\n(Intercept)                   0.0007787283   0.04099538\nFrequency(1) Often            6.9527422236 124.05335127\nFrequency(2) Sometimes        2.0455236747  29.77337909\nFrequency(3) Rarely           0.9950214766  22.11627535\nAge                           0.9393219601   1.01877313\nEducation(2) 12 Years         0.2813356647   2.18558623\nEducation(3) 13 - 15 Years    0.0551199739   0.69073403\nEducation(4) 16 or More Years 0.1250609421   2.03005911\n```\n:::\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n```{.r .cell-code}\nvif(a3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              GVIF Df GVIF^(1/(2*Df))\nFrequency 4.900012  3        1.303265\nAge       1.469820  1        1.212361\nEducation 4.794003  3        1.298523\n```\n:::\n\n```{.r .cell-code}\na4 <- svyglm (I_ALD30 ~ Frequency + Age + Education + Employment, family = binomial(link = \"logit\"), design = d1w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n```\n:::\n\n```{.r .cell-code}\nsummary(a4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nsvyglm(formula = I_ALD30 ~ Frequency + Age + Education + Employment, \n    design = d1w, family = binomial(link = \"logit\"))\n\nSurvey design:\nsvydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, \n    cluster = ~SECU, data = d1)\n\nCoefficients:\n                               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                    -5.26812    1.07042  -4.922 8.87e-07 ***\nFrequency(1) Often              3.23967    0.77097   4.202 2.69e-05 ***\nFrequency(2) Sometimes          2.00308    0.71858   2.788  0.00533 ** \nFrequency(3) Rarely             1.54110    0.80015   1.926  0.05416 .  \nAge                            -0.02291    0.02084  -1.099  0.27187    \nEducation(2) 12 Years          -0.10861    0.58686  -0.185  0.85318    \nEducation(3) 13 - 15 Years     -1.50998    0.68618  -2.201  0.02781 *  \nEducation(4) 16 or More Years  -0.53025    0.80909  -0.655  0.51227    \nEmployment(2) Student         -12.41319    0.51407 -24.147  < 2e-16 ***\nEmployment(3) Homemaker        -1.11577    1.06911  -1.044  0.29670    \nEmployment(4) Retired          -0.34921    1.04638  -0.334  0.73860    \nEmployment(5) Other             0.64206    0.57393   1.119  0.26331    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 0.8436852)\n\nNumber of Fisher Scoring iterations: 16\n```\n:::\n\n```{.r .cell-code}\na5 <- svyglm (I_ALD30 ~ Frequency + Age + Education + Income, family = binomial(link = \"logit\"), design = d1w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n```\n:::\n\n```{.r .cell-code}\nsummary(a5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nsvyglm(formula = I_ALD30 ~ Frequency + Age + Education + Income, \n    design = d1w, family = binomial(link = \"logit\"))\n\nSurvey design:\nsvydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, \n    cluster = ~SECU, data = d1)\n\nCoefficients:\n                                                        Estimate Std. Error\n(Intercept)                                             -5.03413    0.94177\nFrequency(1) Often                                       3.32492    0.74335\nFrequency(2) Sometimes                                   2.00048    0.69479\nFrequency(3) Rarely                                      1.56428    0.78780\nAge                                                     -0.01708    0.01900\nEducation(2) 12 Years                                   -0.05235    0.55855\nEducation(3) 13 - 15 Years                              -1.39122    0.69577\nEducation(4) 16 or More Years                           -0.45410    0.78233\nIncome(2) Income Per Capita Between $12,875 and $25,749 -0.68883    0.53424\nIncome(3) Income Per Capita Between $25,750 and $51,499 -1.36452    0.54356\nIncome(4) Income Per Capita $51,500 or More             -0.24294    0.67312\n                                                        t value Pr(>|t|)    \n(Intercept)                                              -5.345 9.43e-08 ***\nFrequency(1) Often                                        4.473 7.89e-06 ***\nFrequency(2) Sometimes                                    2.879   0.0040 ** \nFrequency(3) Rarely                                       1.986   0.0471 *  \nAge                                                      -0.899   0.3689    \nEducation(2) 12 Years                                    -0.094   0.9253    \nEducation(3) 13 - 15 Years                               -2.000   0.0456 *  \nEducation(4) 16 or More Years                            -0.580   0.5616    \nIncome(2) Income Per Capita Between $12,875 and $25,749  -1.289   0.1973    \nIncome(3) Income Per Capita Between $25,750 and $51,499  -2.510   0.0121 *  \nIncome(4) Income Per Capita $51,500 or More              -0.361   0.7182    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 0.9638713)\n\nNumber of Fisher Scoring iterations: 9\n```\n:::\n\n```{.r .cell-code}\na6 <- svyglm (I_ALD30 ~ Frequency + Age + Education + Income + Employment, family = binomial(link = \"logit\"), design = d1w)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in eval(family$initialize): non-integer #successes in a binomial glm!\n```\n:::\n\n```{.r .cell-code}\nsummary(a6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nsvyglm(formula = I_ALD30 ~ Frequency + Age + Education + Income + \n    Employment, design = d1w, family = binomial(link = \"logit\"))\n\nSurvey design:\nsvydesign(id = ~RESPID, weights = ~CASEWGT, strata = ~STR, nest = TRUE, \n    cluster = ~SECU, data = d1)\n\nCoefficients:\n                                                         Estimate Std. Error\n(Intercept)                                              -5.07373    1.00715\nFrequency(1) Often                                        3.23875    0.77405\nFrequency(2) Sometimes                                    1.98372    0.72615\nFrequency(3) Rarely                                       1.57673    0.80117\nAge                                                      -0.01713    0.01872\nEducation(2) 12 Years                                     0.03094    0.60601\nEducation(3) 13 - 15 Years                               -1.33018    0.72031\nEducation(4) 16 or More Years                            -0.38008    0.84325\nIncome(2) Income Per Capita Between $12,875 and $25,749  -0.68545    0.54692\nIncome(3) Income Per Capita Between $25,750 and $51,499  -1.34737    0.56703\nIncome(4) Income Per Capita $51,500 or More              -0.24912    0.71258\nEmployment(2) Student                                   -12.65602    0.62561\nEmployment(3) Homemaker                                  -1.35477    1.09825\nEmployment(4) Retired                                    -0.59939    1.08812\nEmployment(5) Other                                       0.34973    0.61013\n                                                        t value Pr(>|t|)    \n(Intercept)                                              -5.038 4.88e-07 ***\nFrequency(1) Often                                        4.184 2.91e-05 ***\nFrequency(2) Sometimes                                    2.732  0.00632 ** \nFrequency(3) Rarely                                       1.968  0.04912 *  \nAge                                                      -0.915  0.36017    \nEducation(2) 12 Years                                     0.051  0.95928    \nEducation(3) 13 - 15 Years                               -1.847  0.06485 .  \nEducation(4) 16 or More Years                            -0.451  0.65220    \nIncome(2) Income Per Capita Between $12,875 and $25,749  -1.253  0.21016    \nIncome(3) Income Per Capita Between $25,750 and $51,499  -2.376  0.01753 *  \nIncome(4) Income Per Capita $51,500 or More              -0.350  0.72665    \nEmployment(2) Student                                   -20.230  < 2e-16 ***\nEmployment(3) Homemaker                                  -1.234  0.21742    \nEmployment(4) Retired                                    -0.551  0.58176    \nEmployment(5) Other                                       0.573  0.56653    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 0.9056165)\n\nNumber of Fisher Scoring iterations: 16\n```\n:::\n\n```{.r .cell-code}\nvif(a6)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                GVIF Df GVIF^(1/(2*Df))\nFrequency  12.436557  3        1.522124\nAge         2.093769  1        1.446986\nEducation  12.823064  3        1.529908\nIncome     11.849950  3        1.509916\nEmployment  9.054072  4        1.317060\n```\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n### Functions from the `dplyr` Package\n\n-   `select()`\n-   `distinct()`\n-   `rename()`\n-   `mutate()`\n:::\n::: {.callout-note collapse=\"true\"}\n### Functions from the `tidyr` Package\n\n-   `drop_na()`\n:::\n::: {.callout-note collapse=\"true\"}\n### Functions from the `ggplot2` Package\n\n-   `geom_boxplot()`\n-   `geom_violin()`\n-   `geom_col()`\n:::\n\n## References\n::: {#refs}\n:::",
    "supporting": [
      "Example-analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}